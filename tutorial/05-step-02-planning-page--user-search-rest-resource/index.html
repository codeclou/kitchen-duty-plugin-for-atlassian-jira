<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    
    <title>User Search REST Resource ~ Planning Page | Kitchen Duty Plugin for Atlassian JIRA® by comSysto</title>
    <meta description="Developing the User Search REST Resource for the Planning Page with JAX-RS of Kitchen Duty Plugin for Atlassian JIRA® by comSysto">
    <meta name="robots" content="index, follow">


    
    <meta property="og:title" content="Kitchen Duty Plugin for Atlassian JIRA® by comSysto" />
    <meta property="og:image" content="https://comsysto.github.io/kitchen-duty-plugin-for-atlassian-jira/images/kitchen-duty-plugin--social.jpg" />
    <meta property="og:description" content="An interactive tutorial on how to write Plugins for Atlassian JIRA® by comSysto" />

    
    <link rel="canonical" href="https://comsysto.github.io/kitchen-duty-plugin-for-atlassian-jira/tutorial/05-step-02-planning-page--user-search-rest-resource/" />



    <link href="/kitchen-duty-plugin-for-atlassian-jira/generated/bundle.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Menlo|Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Patrick+Hand' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,900,700|Source+Sans+Pro:400,300,600' rel='stylesheet' type='text/css'>

    <link rel="icon" href="/kitchen-duty-plugin-for-atlassian-jira/images/favicon-32.png" type="image/png" sizes="32x32">
    <link rel="icon" href="/kitchen-duty-plugin-for-atlassian-jira/images/favicon-256.png" type="image/png" sizes="256x256">
    <link rel="icon" href="/kitchen-duty-plugin-for-atlassian-jira/images/favicon.svg" type="image/svg+xml">

    <script>var postLoadMethods = [];</script>
</head>
<body class="cs-tutorial-body">




















    
        
        
        
            
        
        
        
        

        <div class="cs-toc-infographic-wrapper">
            
    <svg class="cs-interactive-graphic"
         id="navSvg11"
         data-json-settings="{
                    &quot;markedAsDone&quot;: [ &quot;webwork-action&quot;, &quot;html-view&quot; ],
                    &quot;markedAsTodo&quot;: [ &quot;user-resource&quot;, &quot;user-search-resource-model&quot; ],
                    &quot;markedAsGrayedOut&quot;: [ ],
                    &quot;onClick&quot;: [ ]
                }"
         data-svg-to-load="kitchen-duty-planning-page--component-overview"
         width="100%"
         viewBox="0 0 1043 654"
         preserveAspectRatio="xMaxYMax">
    </svg>

        </div>
    


    <div class="container-fluid cs-page-header">
        <div class="row">
            <div class="col-md-4 cs-page-header--left-fix">
                <a href="/kitchen-duty-plugin-for-atlassian-jira/"><span class="cs-page-logo">
                <h1>Kitchen Duty Plugin</h1>
                <h2>for Atlassian JIRA® by comSysto</h2>
            </span></a>

            </div>
            <div class="col-md-4 text-xs-center">
                <a class="btn btn-primary cs-stars-on-github-give-star-button" href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira" target="_blank">
                    <span class="cs-stars-on-github-count-stars"></span>
                    <i class="fa fa-star"></i>
                    <span class="cs-stars-on-github-right">Star on GitHub</span>
                </a>
            </div>
            <div class="col-md-4  cs-page-header-cs-logo text-xs-right hidden-xs hidden-sm  cs-page-header--right-fix">
                <a href="https://comsysto.com/leistungen/atlassian-experts-services" target="_blank"><img src="/kitchen-duty-plugin-for-atlassian-jira/images/comsysto-logo.png" alt="comSysto"/></a>
            </div>
        </div>

    </div>

<!-- CONTENT -->



<div class="cs-sidebar-wrapper">
            
    <div id="toc">
        <ul>

            

            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/01-introduction/">
                    Introduction
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/02-step-00-getting-started/">
                    <span class="cs-step-badge pull-right">0</span>
                    Getting Started
                </a>
            </li>

            

            <li class="toc-h2-divider">Part I: Kitchen Duty Planning Page</li>

            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/03-story-workshop-for-planning-page/">
                    Story Workshop for Planning Page
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/04-step-01-planning-page--webwork-action-and-html-view/">
                    <span class="cs-step-badge pull-right">1</span>
                    Webwork Action and HTML View
                </a>
            </li>
            <li class="toc-h2 toc-active"><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/05-step-02-planning-page--user-search-rest-resource/">
                    <span class="cs-step-badge pull-right">2</span>
                    User Search REST Resource
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/06-step-03-planning-page--user-search-js-controller/">
                    <span class="cs-step-badge pull-right">3</span>
                    User Search JS Controller
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/07-step-04-planning-page--kitchen-duty-planning-rest-resource/">
                    <span class="cs-step-badge pull-right">4</span>
                    Kitchen Duty Planning REST Resource
                </a>
            </li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/08-step-05-planning-page--kitchen-duty-planning-js-controller/">
                    <span class="cs-step-badge pull-right">5</span>
                    Kitchen Duty Planning JS Controller
                </a>
            </li>

            

            <li class="toc-h2-divider">Part II: Kitchen Duty Overview Page</li>
            <li class="toc-h2 "><a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/09-story-workshop-for-overview-page/">
                    Story Workshop for Overview Page
                </a>
            </li>
        </ul>


    </div>


</div>

<div class="cs-content-wrapper">
    



<div class="row">
    <div class="col-md-12">
        
    
    
    

    <h2 class="cs-headline cs-headline--m cs-headline--anchor"
        data-scroll-to-headline="user-search-rest-resource"
        data-scroll-to-headline-previous="">
        
        User Search REST Resource
    </h2>






        
        
        



        <p>We will now create the <strong>User Search REST Resource</strong> so that our <strong>JS-Controller can search for usernames</strong>.</p>

        <p>What is a REST Resource? It is simply just a basic Controller (MVC) that reacts to certain HTTP Requests with a specific response.</p>

        <p>
            Atlassian uses <a target="_blank" href="https://en.wikipedia.org/wiki/Java_API_for_XML_Web_Services">JAX-WS</a> and <a target="_blank" href="https://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding">JAXB</a> for it's built in REST Resources.
            The actual implementation is hidden from us, and we don't really care about it since we just need to know that somewhere inside JIRA
            are OSGi bundles which provide the JAX-WS and JAXB implementation.</p>

        <p>Ok, enough of OSGi and theoretical jibber jabber! Let's create our REST Resource with an Atlassian SDK command, like we did create the Webwork Action before.</p>

        <p>Execute the command and choose <a href="https://developer.atlassian.com/docs/atlassian-platform-common-components/rest-api-development/rest-plugin-module" target="_blank"><strong>14: REST Plugin Module</strong></a> and fill out the prompts as stated below.</p>

        
<div class="cs-shell">
    <div class="cs-shell__inner">
        <a class="cs-shell__copy-clipboard cs--trigger-copy-clipboard" data-clipboard-text="atlas-create-jira-plugin-module"
           data-toggle="tooltip" data-placement="left"
           data-title-orig="Copy file content to clipboard"
           title="Copy file content to clipboard"><i class="fa fa-files-o"></i></a>

        atlas-create-jira-plugin-module<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">Executing: /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>/bin/mvn com.atlassian.maven.plugins:maven-jira-plugin:<span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>:create-plugin-module -gs /Applications/Atlassian/atlassian-plugin-sdk-<span class="hljs-number">6.1</span>.<span class="hljs-number">0</span>/apache-maven-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>/conf/settings.xml
Java HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM warning: ignoring option MaxPermSize=<span class="hljs-number">256</span>M; support was removed <span class="hljs-keyword">in</span> <span class="hljs-number">8.0</span>
[INFO] Scanning <span class="hljs-keyword">for</span> projects...
[INFO]
[INFO] Using the builder org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder with a thread count of <span class="hljs-number">1</span>
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building kitchen-duty-plugin <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-jira-plugin:<span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>:create-plugin-module (default-cli) @ kitchen-duty-plugin ---
Choose Plugin Module:
<span class="hljs-number">1</span>:  Component Import
...
<span class="hljs-number">14</span>: REST Plugin Module
<span class="hljs-number">15</span>: RPC Endpoint Plugin
...
Choose a number (...): <span class="hljs-number">14</span>

Enter New Classname MyRestResource: : UserSearchResource
Enter Package Name com.comsysto.rest: : com.comsysto.kitchen.duty.rest
Enter REST Path /usersearchresource: : /kitchenduty
Enter Version <span class="hljs-number">1.0</span>: : <span class="hljs-number">1.0</span>

Show Advanced Setup? (Y/y/N/n) N: : y

Module Name User Search Resource: : Kitchen Duty Resources
Module Key user-search-resource: : kitchen-duty-resources
Module Description The User Search Resource Plugin: : All Kitchen Duty REST Resources
i18n Name Key user-search-resource.name: : kitchen-duty-plugin.rest.resources.name
i18n Description Key user-search-resource.description: : kitchen-duty-plugin.rest.resources.description
Add Package To Scan? (Y/y/N/n) N: : y
Enter Package: com.comsysto.kitchen.duty.rest
...

Add Package To Scan? (Y/y/N/n) N: : n

Add Dispatcher? (Y/y/N/n) N: : n

[INFO] Adding the following items to the project:
[INFO]   [class: com.comsysto.kitchen.duty.rest.UserSearchResourceModel]
[INFO]   [class: com.comsysto.kitchen.duty.rest.UserSearchResource]
[INFO]   [class: it.com.comsysto.kitchen.duty.rest.UserSearchResourceFuncTest]
[INFO]   [class: ut.com.comsysto.kitchen.duty.rest.UserSearchResourceTest]
[INFO]   [dependency: com.atlassian.plugins.rest:atlassian-rest-common]
[INFO]   [dependency: com.atlassian.sal:sal-api]
[INFO]   [dependency: javax.servlet:servlet-api]
[INFO]   [dependency: javax.ws.rs:jsr311-api]
[INFO]   [dependency: javax.xml.bind:jaxb-api]
[INFO]   [dependency: org.apache.wink:wink-client]
[INFO]   [dependency: org.mockito:mockito-all]
[INFO]   [module: rest]
[INFO]   i18n strings: <span class="hljs-number">2</span>

Add Another Plugin Module? (Y/y/N/n) N: : n

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: <span class="hljs-number">01</span>:<span class="hljs-number">52</span> min
[INFO] Finished at: <span class="hljs-number">2016</span>-<span class="hljs-number">01</span>-<span class="hljs-number">16</span>T20:<span class="hljs-number">07</span>:<span class="hljs-number">35</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>
[INFO] Final Memory: <span class="hljs-number">24</span>M/<span class="hljs-number">328</span>M
[INFO] ------------------------------------------------------------------------</code></pre>

    </div>
</div>



        <p>The SDK created and updated many files now and before we get into all the details let's fire up <code>atlas-run</code> again
            and see what has been created for us.</p>

        <p>Once JIRA is started <strong>browse to <a class="cs-do-wrap" href="http://server/jira/rest/kitchenduty/1.0/message" target="_blank">http://server/jira/rest/kitchenduty/1.0/message</a></strong> and you should see the following.</p>

        <div class="row">
            <div class="col-md-offset-2 col-md-8">
                <p>
                    <a href="/kitchen-duty-plugin-for-atlassian-jira/images/doc/step-02-rest-user-search-response-xml.png" data-lightbox="02-step" data-title="Step 2 - XML Response of User Search REST Resource">
                        <img src="/kitchen-duty-plugin-for-atlassian-jira/images/doc/step-02-rest-user-search-response-xml.png" class="img-thumbnail img-fluid" alt="Step 2 - XML Response of User Search REST Resource">
                    </a>
                </p>
            </div>
        </div>



        <p>That's nice. But now we need to understand what is going on. So here is a <strong>short recap of what has been created</strong>.</p>

        <ol>
            <li><p>The <code>pom.xml</code> has been altered to provide necessary dependencies for JAX-WS API, Servlet API and some testing Dependencies.</p></li>
            <li><p>The <code>atlassian-plugin.xml</code> has been altered to register the REST Resource to listen to the baseUrl <code>http://server/jira/rest/kitchenduty/1.0/*</code></p></li>
            <li><p>There now is a <code>UserSearchResource.java</code> which is the actual REST Controller which delivers the response.</p>
                <p>In addition to the REST Controller there is <code>UserSearchResourceModel.java</code> which is the Model which is delivered as XML in the REST Controllers response.</p>
            </li>
            <li><p>An unit-test <code>UserSearchResourceTest</code> and integration-test <code>UserSearchResourceFuncTest</code> file has be created.</p></li>
        </ol>

        <p>We will now get into all the details and implement the needed features for the user search on the fly.</p>

        <h3 class="cs-headline cs-headline--s">1. Dependencies <em>(pom.xml)</em></h3>

        <p>The <code>pom.xml</code> has these new lines which are quite self explanatory. If you want to read everything in detail read the <a href="https://developer.atlassian.com/docs/atlassian-platform-common-components/rest-api-development/rest-plugin-module" target="_blank">REST Plugin Module documentation</a>.</p>

        
    
        <div class="cs-code-filename">pom.xml
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/pom.xml" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
    &lt;version&gt;2.4&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
    &lt;version&gt;2.1&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.atlassian.plugins.rest&lt;/groupId&gt;
    &lt;artifactId&gt;atlassian-rest-common&lt;/artifactId&gt;
    &lt;version&gt;1.0.2&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.wink&lt;/groupId&gt;
    &lt;artifactId&gt;wink-client&lt;/artifactId&gt;
    &lt;version&gt;1.1.3-incubating&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>javax.servlet<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>servlet-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.4<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>javax.xml.bind<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>jaxb-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.atlassian.plugins.rest<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>atlassian-rest-common<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.0.2<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.apache.wink<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>wink-client<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.1.3-incubating<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span></code></pre>


        




        <h3 class="cs-headline cs-headline--s">2. REST Resources Handler <em>(atlassian-plugin.xml)</em></h3>

        <p>As already mentioned the <code>atlassian-plugin.xml</code> has been altered to register the REST Resource to listen to the baseUrl <code>http://server/jira/rest/kitchenduty/1.0/*</code>.</p>

        <p>The <code>path</code> and <code>version</code> build the baseurl relative to <code>http://server/jira/rest/*</code>.</p>

        <p><code>package</code> will enable Component Scan (which I think is redundant, but doesn't hurt).</p>

        
    
        <div class="cs-code-filename">src/main/resources/atlassian-plugin.xml
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/main/resources/atlassian-plugin.xml" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="&lt;rest name=&quot;Kitchen Duty Resources&quot;
      i18n-name-key=&quot;kitchen-duty-plugin.rest.resources.name&quot;
      key=&quot;kitchen-duty-resources&quot;
      path=&quot;/kitchenduty&quot;
      version=&quot;1.0&quot;&gt;
  &lt;description key=&quot;kitchen-duty-plugin.rest.resources.description&quot;&gt;All Kitchen Duty REST Resources&lt;/description&gt;
  &lt;package&gt;com.comsysto.kitchen.duty.rest&lt;/package&gt;
&lt;/rest&gt;"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">rest</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"Kitchen Duty Resources"</span>
      <span class="hljs-attribute">i18n-name-key</span>=<span class="hljs-value">"kitchen-duty-plugin.rest.resources.name"</span>
      <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-resources"</span>
      <span class="hljs-attribute">path</span>=<span class="hljs-value">"/kitchenduty"</span>
      <span class="hljs-attribute">version</span>=<span class="hljs-value">"1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">description</span> <span class="hljs-attribute">key</span>=<span class="hljs-value">"kitchen-duty-plugin.rest.resources.description"</span>&gt;</span>All Kitchen Duty REST Resources<span class="hljs-tag">&lt;/<span class="hljs-title">description</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">package</span>&gt;</span>com.comsysto.kitchen.duty.rest<span class="hljs-tag">&lt;/<span class="hljs-title">package</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">rest</span>&gt;</span></code></pre>


        <p>You already know <code>i18n-name-key</code> and the other attributes from the Webwork Action and therefore are not wondering that there are some new i18n key/value pairs inside <code>kitchen-duty-plugin.properties</code>.</p>

        
    
        <div class="cs-code-filename">src/main/resources/kitchen-duty-plugin.properties
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/main/resources/kitchen-duty-plugin.properties" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="kitchen-duty-plugin.rest.resources.name=Kitchen Duty Resources
kitchen-duty-plugin.rest.resources.description=All Kitchen Duty REST Resources"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs">kitchen-duty-plugin.rest.resources.name=Kitchen Duty Resources
kitchen-duty-plugin.rest.resources.description=All Kitchen Duty REST Resources</code></pre>



        <h3 class="cs-headline cs-headline--s">3. REST Controller and Model</h3>

        <p>
            In the directory <code>src/main/java/</code> in the package <code>com.comsysto.kitchen.duty.rest</code> there is now the
            <code>UserSearchResource.java</code> and the <code>UserSearchResourceModel.java</code>. You can see what has been created in the <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/commit/95b8ebf5ff20a77c6b0853cd93ad0b465033e6f6">GitHub commit 95b8ebf</a>.
        </p>

        <p>
            We will change the code to <strong>provide GET Endpoint to search usernames</strong>.
        </p>

        <div class="row">
            <div class="col-md-6">
                
                
    
        <div class="cs-code-filename">src/main/java/com/comsysto/kitchen/duty/rest/UserSearchResource.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/main/java/com/comsysto/kitchen/duty/rest/UserSearchResource.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="package com.comsysto.kitchen.duty.rest;

import com.atlassian.jira.bc.user.search.UserSearchParams;
import com.atlassian.jira.bc.user.search.UserSearchService;
import com.atlassian.plugins.rest.common.security.AnonymousAllowed;

import javax.inject.Inject;
import javax.inject.Named;
import javax.servlet.http.HttpServletRequest;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.QueryParam;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;
import java.util.ArrayList;
import java.util.List;

@Named 
@Path(&quot;/user&quot;)  
public class UserSearchResource {

    private UserSearchService userSearchService; 

    @Inject 
    public UserSearchResource(UserSearchService userSearchService) {
        this.userSearchService = userSearchService;
    }

    
    public UserSearchResource() {
    }

    @GET
    @Path(&quot;/health&quot;) 
    @Produces({MediaType.APPLICATION_JSON})
    @AnonymousAllowed 
    public Response health() {
        return Response.ok(&quot;ok&quot;).build();
    }

    /**
     * Call from select2 JS plugin
     * Response needs to look like this:
     * [{ &#39;id&#39;: 1, &#39;text&#39;: &#39;Demo&#39; }, { &#39;id&#39;: 2, &#39;text&#39;: &#39;Demo 2&#39;}]
     */
    @GET
    @Path(&quot;/search&quot;) 
    @Produces({MediaType.APPLICATION_JSON})
    public Response searchUsers(@QueryParam(&quot;query&quot;) final String userQuery, 
                                @Context HttpServletRequest request ) {
        List&lt;UserSearchResourceModel&gt; users = findUsers(userQuery);
        return Response.ok(users).build(); 
    }

    private List&lt;UserSearchResourceModel&gt; findUsers(String query) {
        List&lt;UserSearchResourceModel&gt; userSearchResourceModels =
                                           new ArrayList&lt;UserSearchResourceModel&gt;();
        UserSearchParams searchParams = UserSearchParams.builder()
            .includeActive(true)
            .sorted(true)
            .build();
        List&lt;String&gt; users = userSearchService.findUserNames(query, searchParams); 
        if (users != null) {
            for (String user : users) {
                userSearchResourceModels.add(new UserSearchResourceModel(user, user));
            }
        }
        return userSearchResourceModels;
    }
}"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">package</span> com.comsysto.kitchen.duty.rest;

<span class="hljs-keyword">import</span> com.atlassian.jira.bc.user.search.UserSearchParams;
<span class="hljs-keyword">import</span> com.atlassian.jira.bc.user.search.UserSearchService;
<span class="hljs-keyword">import</span> com.atlassian.plugins.rest.common.security.AnonymousAllowed;

<span class="hljs-keyword">import</span> javax.inject.Inject;
<span class="hljs-keyword">import</span> javax.inject.Named;
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;
<span class="hljs-keyword">import</span> javax.ws.rs.GET;
<span class="hljs-keyword">import</span> javax.ws.rs.Path;
<span class="hljs-keyword">import</span> javax.ws.rs.Produces;
<span class="hljs-keyword">import</span> javax.ws.rs.QueryParam;
<span class="hljs-keyword">import</span> javax.ws.rs.core.Context;
<span class="hljs-keyword">import</span> javax.ws.rs.core.MediaType;
<span class="hljs-keyword">import</span> javax.ws.rs.core.Response;
<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-annotation">@Named</span> <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="1"></span>
<span class="hljs-annotation">@Path</span>(<span class="hljs-string">"/user"</span>)  <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="2"></span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserSearchResource</span> </span>{

    <span class="hljs-keyword">private</span> UserSearchService userSearchService; <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="3"></span>

    <span class="hljs-annotation">@Inject</span> <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="4"></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UserSearchResource</span><span class="hljs-params">(UserSearchService userSearchService)</span> </span>{
        <span class="hljs-keyword">this</span>.userSearchService = userSearchService;
    }

    <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="5"></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UserSearchResource</span><span class="hljs-params">()</span> </span>{
    }

    <span class="hljs-annotation">@GET</span>
    <span class="hljs-annotation">@Path</span>(<span class="hljs-string">"/health"</span>) <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="6"></span>
    <span class="hljs-annotation">@Produces</span>({MediaType.APPLICATION_JSON})
    <span class="hljs-annotation">@AnonymousAllowed</span> <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="7"></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Response <span class="hljs-title">health</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Response.ok(<span class="hljs-string">"ok"</span>).build();
    }

    <span class="hljs-comment">/**
     * Call from select2 JS plugin
     * Response needs to look like this:
     * [{ 'id': 1, 'text': 'Demo' }, { 'id': 2, 'text': 'Demo 2'}]
     */</span>
    <span class="hljs-annotation">@GET</span>
    <span class="hljs-annotation">@Path</span>(<span class="hljs-string">"/search"</span>) <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="8"></span>
    <span class="hljs-annotation">@Produces</span>({MediaType.APPLICATION_JSON})
    <span class="hljs-function"><span class="hljs-keyword">public</span> Response <span class="hljs-title">searchUsers</span><span class="hljs-params">(@QueryParam(<span class="hljs-string">"query"</span>)</span> <span class="hljs-keyword">final</span> String userQuery, </span><span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="9"></span>
                                <span class="hljs-annotation">@Context</span> HttpServletRequest request <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="10"></span>) {
        List&lt;UserSearchResourceModel&gt; users = findUsers(userQuery);
        <span class="hljs-keyword">return</span> Response.ok(users).build(); <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="11"></span>
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;UserSearchResourceModel&gt; <span class="hljs-title">findUsers</span><span class="hljs-params">(String query)</span> </span>{
        List&lt;UserSearchResourceModel&gt; userSearchResourceModels =
                                           <span class="hljs-keyword">new</span> ArrayList&lt;UserSearchResourceModel&gt;();
        UserSearchParams searchParams = UserSearchParams.builder()
            .includeActive(<span class="hljs-keyword">true</span>)
            .sorted(<span class="hljs-keyword">true</span>)
            .build();
        List&lt;String&gt; users = userSearchService.findUserNames(query, searchParams); <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresource" data-cs-source-point-number="12"></span>
        <span class="hljs-keyword">if</span> (users != <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">for</span> (String user : users) {
                userSearchResourceModels.add(<span class="hljs-keyword">new</span> UserSearchResourceModel(user, user));
            }
        }
        <span class="hljs-keyword">return</span> userSearchResourceModels;
    }
}</code></pre>

            </div>
            <div class="col-md-6">

                <div class="list-group cs-source-point-list" data-source-target="step2-usersearchresource">
                    <div class="list-group-item cs-source-point-list__item">
                        Our REST Controller should be a Spring-Bean and get its dependencies autowired. Therefore provide the JSR annotation <code>@Named</code>
                        on classlevel.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        We want that all REST Endpoints of our REST Controller will have an URL-prefix <code>/user</code>, therefore we use the <code>@Path</code> annotation.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        The <code>UserSearchService</code> is a JIRA Service which will provide us methods to search for users. This Servie needs to be imported from a foreign OSGi bundle, we will see about that later.
                        Why not use <code>@ComponentImport</code> here you ask? Well try and if it works for you that would be nice. But I am getting some strange WADLGenerator Exceptions when running <code>atlas-integration-test</code>.
                        Therefore I use a little trick and import the component somewhere else. Once it is imported somewhere inside our bundle we can use it here. We will see about that later.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        We use <code>@Inject</code> for constructor injection, so that our UserSearchService will be injected by Spring on bean creation.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        We provide a default constructor just in case.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        Since our user search Endpoint will be rather complex we want a simple health endpoint to test the REST API in an easy way.
                        Therefore we define a Method as <code>@GET</code> with <code>@Path("/health")</code> which produces JSON <code>@Produces({MediaType.APPLICATION_JSON})</code>.
                        This endpoint will be reachable via <code>http://localhost:2990/jira/rest/kitchenduty/1.0/user/health</code>.
                    </div>
                    <a class="list-group-item cs-source-point-list__item">
                        The health endpoint will be reachable without authentication via <code>@AnonymousAllowed</code>.
                        So you can curl the URL easily and will get an <code>ok</code> as response.
                    </a>
                    <div class="list-group-item cs-source-point-list__item">
                        Alright now we code the actual user search Endpoint with <code>@Path("/search")</code>. We do NOT use <code>@AnonymousAllowed</code> here
                        because we don't want unauthenticated users search our user database.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        As we want to search for username, somehow our search keyword needs to be passed as URL-parameter. This
                        is done via <code>@QueryParam("query")</code> which leads to the following URL for our endpoint
                        <code>http://localhost:2990/jira/rest/kitchenduty/1.0/user/search?query=foo</code>.
                        <br><br>Why use QueryParam instead of PathParam you ask? I see you like nice URL-patterns and so do I, but we will see later that the AUI select2 widget
                        will send the search keyword as <code>query</code> param, so we stick to this default behaviour.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        With <code>@Context HttpServletRequest request</code> we get the HTTP-Request as paramater and could for example extract the authenticated user.
                        We don't need it now but we might soon. <code>@Context</code> ensures that JIRA context (I think special headers and stuff) is wired into the request.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        After we searched for users we build the response with <code>Response.ok(someObject).build()</code>.
                        The JAXB/JAX-WS implementation ensures that our Model (we will see about that later) is converted to JSON and that a HTTP 200 is send together with the JSON representation of our Object as response body.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        We provide a private method that searches for usernames using the <code>UserSearchService</code>. If your OSGi component imports are not working correctly you will get a <em>NullPointerException</em> here.
                        After we searched the usernames we convert the username list into our model <code>UserSearchResourceModel</code> which will be serialized as JSON response body.
                    </div>
                </div>
            </div>

        </div>



        <div class="cs-v-spacer"></div>



        <p>
            Now we have the REST Controller but you will have some compile errors now because the <strong>Model needs to be implemented</strong>.
        </p>

        <div class="row">
            <div class="col-md-6">
                

                
    
        <div class="cs-code-filename">src/main/java/com/comsysto/kitchen/duty/rest/UserSearchResourceModel.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/main/java/com/comsysto/kitchen/duty/rest/UserSearchResourceModel.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="package com.comsysto.kitchen.duty.rest;

import javax.xml.bind.annotation.*;
@XmlRootElement(name = &quot;users&quot;) 
@XmlAccessorType(XmlAccessType.FIELD) 
public class UserSearchResourceModel {

    @XmlElement 
    private String text;

    @XmlElement 
    private String id;

    public UserSearchResourceModel() {
    }

    public UserSearchResourceModel(String text, String id) {
        this.text = text;
        this.id = id;
    }

    public String getText() {
        return text;
    }

    public void setText(String text) {
        this.text = text;
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }
}"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">package</span> com.comsysto.kitchen.duty.rest;

<span class="hljs-keyword">import</span> javax.xml.bind.annotation.*;
<span class="hljs-annotation">@XmlRootElement</span>(name = <span class="hljs-string">"users"</span>) <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcemodel" data-cs-source-point-number="1"></span>
<span class="hljs-annotation">@XmlAccessorType</span>(XmlAccessType.FIELD) <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcemodel" data-cs-source-point-number="2"></span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserSearchResourceModel</span> </span>{

    <span class="hljs-annotation">@XmlElement</span> <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcemodel" data-cs-source-point-number="3"></span>
    <span class="hljs-keyword">private</span> String text;

    <span class="hljs-annotation">@XmlElement</span> <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcemodel" data-cs-source-point-number="4"></span>
    <span class="hljs-keyword">private</span> String id;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UserSearchResourceModel</span><span class="hljs-params">()</span> </span>{
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UserSearchResourceModel</span><span class="hljs-params">(String text, String id)</span> </span>{
        <span class="hljs-keyword">this</span>.text = text;
        <span class="hljs-keyword">this</span>.id = id;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getText</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> text;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setText</span><span class="hljs-params">(String text)</span> </span>{
        <span class="hljs-keyword">this</span>.text = text;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(String id)</span> </span>{
        <span class="hljs-keyword">this</span>.id = id;
    }
}</code></pre>

            </div>
            <div class="col-md-6">

                <div class="list-group cs-source-point-list" data-source-target="step2-usersearchresourcemodel">
                    <div class="list-group-item cs-source-point-list__item">
                        Currently we only use JSON and have disabled XML as response format.
                        But if you someday want to use XML you will need a name for the container holding users.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        This basically tells the compiler to look for <code>@XmlElement</code> on the attribute level and not on the getters/setters.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        Since the select2 widget from AUI wants to have a certain JSON format we just stick to that and define a property called <code>text</code>.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        The same thing for the property called <code>id</code>.
                    </div>
                    <div class="list-group-item">
                        Ok this will render us the following JSON format once we use it:<br>
                        <code>[ { "id": "foo", "text": "foo" }, { "id": "bar", "text": "bar" } ]</code>
                    </div>

                </div>
            </div>

        </div>


        <div class="cs-v-spacer cs-v-spacer"></div>



        <p>
            Ok we could run <code>atlas-run</code> now and see what we get, but as I told you we need to take care of the <code>@ComponentImport</code>
            of <code>UserSearchService</code> first. Since it doesn't matter where in our plugin we import foreign Interfaces we do it in the "dummy"-component so
            our imports will be available everywhere in our plugin.
        </p>

        <p>
            
    
        <div class="cs-code-filename">src/main/java/com/comsysto/kitchen/duty/impl/MyPluginComponentImpl.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/main/java/com/comsysto/kitchen/duty/impl/MyPluginComponentImpl.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="package com.comsysto.kitchen.duty.rest;

import com.atlassian.jira.bc.user.search.UserSearchService;
import com.atlassian.plugin.spring.scanner.annotation.imports.ComponentImport;
...

@Named (&quot;myPluginComponent&quot;)
public class MyPluginComponentImpl implements MyPluginComponent {
   ...
   @ComponentImport
   private UserSearchService userSearchService;
   ...
}"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">package</span> com.comsysto.kitchen.duty.rest;

<span class="hljs-keyword">import</span> com.atlassian.jira.bc.user.search.UserSearchService;
<span class="hljs-keyword">import</span> com.atlassian.plugin.spring.scanner.annotation.imports.ComponentImport;
...

<span class="hljs-annotation">@Named</span> (<span class="hljs-string">"myPluginComponent"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPluginComponentImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MyPluginComponent</span> </span>{
   ...
   <span class="hljs-annotation">@ComponentImport</span>
   <span class="hljs-keyword">private</span> UserSearchService userSearchService;
   ...
}</code></pre>

        </p>

        <div class="cs-v-spacer"></div>


        <h3 class="cs-headline cs-headline--s">4. Unit- and Integrationtests</h3>

        <p>
            Now that we have our code ready we need to take care of the <strong>Unit- and Integration-tests</strong>.
        </p>

        <p>
            First we will change the <strong>Unitest</strong> which reside in <code>/src/test/java/*</code> to something that makes sense. So we mock the <code>UserSearchService</code>
            and provide two users <code>bob</code> and <code>sue</code> as mocks. Now we test if our <code>searchUser</code> Method works as expected.
        </p>

        
    
        <div class="cs-code-filename">src/test/java/ut/com/comsysto/kitchen/duty/rest/UserSearchResourceTest.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/test/java/ut/com/comsysto/kitchen/duty/rest/UserSearchResourceTest.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="package ut.com.comsysto.kitchen.duty.rest;

import com.atlassian.jira.bc.user.search.UserSearchParams;
import com.atlassian.jira.bc.user.search.UserSearchService;
import com.comsysto.kitchen.duty.rest.UserSearchResource;
import com.comsysto.kitchen.duty.rest.UserSearchResourceModel;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.mockito.Mockito;

import javax.ws.rs.core.Response;
import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.mockito.Matchers.any;
import static org.mockito.Matchers.anyObject;
import static org.mockito.Matchers.anyString;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

public class UserSearchResourceTest {

    @Before
    public void setup() {

    }

    @After
    public void tearDown() {

    }

    @Test
    public void messageIsValid() {
        final List&lt;String&gt; mockedUsers = new ArrayList&lt;&gt;();
        mockedUsers.add(&quot;bob&quot;);
        mockedUsers.add(&quot;sue&quot;);

        UserSearchService mockedUserSearchService = Mockito.mock(UserSearchService.class);
        when(mockedUserSearchService.findUserNames(anyString(), any(UserSearchParams.class))).thenReturn(mockedUsers);

        UserSearchResource resource = new UserSearchResource(mockedUserSearchService);

        Response response = resource.searchUsers(&quot;bo&quot;, null);
        final List&lt;UserSearchResourceModel&gt; users = (List&lt;UserSearchResourceModel&gt;) response.getEntity();

        assertEquals(&quot;should contain bob&quot;, &quot;bob&quot;, users.get(0).getText());
    }
}"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">package</span> ut.com.comsysto.kitchen.duty.rest;

<span class="hljs-keyword">import</span> com.atlassian.jira.bc.user.search.UserSearchParams;
<span class="hljs-keyword">import</span> com.atlassian.jira.bc.user.search.UserSearchService;
<span class="hljs-keyword">import</span> com.comsysto.kitchen.duty.rest.UserSearchResource;
<span class="hljs-keyword">import</span> com.comsysto.kitchen.duty.rest.UserSearchResourceModel;
<span class="hljs-keyword">import</span> org.junit.After;
<span class="hljs-keyword">import</span> org.junit.Before;
<span class="hljs-keyword">import</span> org.junit.Test;
<span class="hljs-keyword">import</span> org.mockito.Mockito;

<span class="hljs-keyword">import</span> javax.ws.rs.core.Response;
<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.assertEquals;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.assertNotNull;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.mockito.Matchers.any;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.mockito.Matchers.anyObject;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.mockito.Matchers.anyString;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.mockito.Mockito.mock;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.mockito.Mockito.when;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserSearchResourceTest</span> </span>{

    <span class="hljs-annotation">@Before</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{

    }

    <span class="hljs-annotation">@After</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tearDown</span><span class="hljs-params">()</span> </span>{

    }

    <span class="hljs-annotation">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">messageIsValid</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">final</span> List&lt;String&gt; mockedUsers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
        mockedUsers.add(<span class="hljs-string">"bob"</span>);
        mockedUsers.add(<span class="hljs-string">"sue"</span>);

        UserSearchService mockedUserSearchService = Mockito.mock(UserSearchService.class);
        when(mockedUserSearchService.findUserNames(anyString(), any(UserSearchParams.class))).thenReturn(mockedUsers);

        UserSearchResource resource = <span class="hljs-keyword">new</span> UserSearchResource(mockedUserSearchService);

        Response response = resource.searchUsers(<span class="hljs-string">"bo"</span>, <span class="hljs-keyword">null</span>);
        <span class="hljs-keyword">final</span> List&lt;UserSearchResourceModel&gt; users = (List&lt;UserSearchResourceModel&gt;) response.getEntity();

        assertEquals(<span class="hljs-string">"should contain bob"</span>, <span class="hljs-string">"bob"</span>, users.get(<span class="hljs-number">0</span>).getText());
    }
}</code></pre>


        <p>
            Now we can run <code>atlas-unit-test</code> to run all our Unittests.
        </p>


        
<div class="cs-shell">
    <div class="cs-shell__inner">
        <a class="cs-shell__copy-clipboard cs--trigger-copy-clipboard" data-clipboard-text="atlas-unit-test"
           data-toggle="tooltip" data-placement="left"
           data-title-orig="Copy file content to clipboard"
           title="Copy file content to clipboard"><i class="fa fa-files-o"></i></a>

        atlas-unit-test<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">[INFO] ------------------------------------------------------------------------
[INFO] Building kitchen-duty-plugin <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-jira-plugin:<span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>:compress-resources (default-compress-resources) @ kitchen-duty-plugin ---
[INFO] Compiling javascript using YUI
...

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running ut.com.comsysto.kitchen.duty.MyComponentUnitTest
Tests run: <span class="hljs-number">1</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>, Time elapsed: <span class="hljs-number">0.051</span> sec
Running ut.com.comsysto.kitchen.duty.rest.UserSearchResourceTest
Tests run: <span class="hljs-number">1</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>, Time elapsed: <span class="hljs-number">0.148</span> sec
Running ut.com.comsysto.kitchen.duty.webwork.KitchenDutyPlanningWebworkActionTest
Tests run: <span class="hljs-number">1</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>, Time elapsed: <span class="hljs-number">0</span> sec

Results :

Tests run: <span class="hljs-number">3</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: <span class="hljs-number">3.477</span> s
[INFO] Finished at: <span class="hljs-number">2016</span>-<span class="hljs-number">03</span>-<span class="hljs-number">11</span>T19:<span class="hljs-number">34</span>:<span class="hljs-number">06</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>
[INFO] Final Memory: <span class="hljs-number">25</span>M/<span class="hljs-number">320</span>M
[INFO] ------------------------------------------------------------------------</code></pre>

    </div>
</div>


        <div class="cs-v-spacer cs-v-spacer"></div>

        <p>
            Now that Unittests are working let us modify the created <strong>Integrationtest</strong>.
        </p>


        <div class="row">
            <div class="col-md-6">
                
                
    
        <div class="cs-code-filename">src/test/java/it/com/comsysto/kitchen/duty/rest/UserSearchResourceFuncTest.java
            
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/blob/master/step-02-kitchen-duty-plugin/src/test/java/it/com/comsysto/kitchen/duty/rest/UserSearchResourceFuncTest.java" target="_blank"
                   data-toggle="tooltip" data-placement="left" title="Open file on GitHub"
                   class="cs-code-ghlink"><i class="fa fa-github"></i></a>
            
            <a class="cs-code-copylink cs--trigger-copy-clipboard"
               data-toggle="tooltip" data-placement="left"
               data-title-orig="Copy file content to clipboard"
               title="Copy file content to clipboard"
               data-clipboard-text="package it.com.comsysto.kitchen.duty.rest;

import org.apache.wink.client.ClientConfig;
import org.apache.wink.client.Resource;
import org.apache.wink.client.RestClient;
import org.apache.wink.client.handlers.BasicAuthSecurityHandler;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;

public class UserSearchResourceFuncTest {

    private String baseUrl;

    @Before
    public void setup() {
        baseUrl = System.getProperty(&quot;baseurl&quot;); 
    }

    @After
    public void tearDown() {

    }

    @Test
    public void testSearchUser__unAuthorized() { 
        String resourceUrl = baseUrl + &quot;/rest/kitchenduty/1.0/user/search?query=adm&quot;;
        String response = httpGet(resourceUrl);
        assertNotNull(&quot;should not be null&quot;, response);
        assertEquals(&quot;should contain unauthorized message&quot;,
            toJSON(&quot;{&#39;message&#39;:&#39;Client must be authenticated to access this resource.&#39;,&#39;status-code&#39;:401}&quot;),
            response);
    }
    @Test
    public void testSearchUser__authorized() { 
        String resourceUrl = baseUrl + &quot;/rest/kitchenduty/1.0/user/search?query=adm&quot;;
        String response = httpGet(resourceUrl, &quot;admin&quot;, &quot;admin&quot;);
        assertNotNull(&quot;should not be null&quot;, response);
        assertEquals(&quot;should contain admin&quot;,
            toJSON(&quot;[{&#39;text&#39;:&#39;admin&#39;,&#39;id&#39;:&#39;admin&#39;}]&quot;),
            response);
    }

    private String toJSON(String text) { 
        return text.replaceAll(&quot;&#39;&quot;, &quot;\&quot;&quot;);
    }

    private String httpGet(String url) { 
        return _httpGet(url, null);
    }

    private String httpGet(String url, String username, String password) { 
        ClientConfig config = new ClientConfig();
        BasicAuthSecurityHandler basicAuthSecHandler = new BasicAuthSecurityHandler();
        basicAuthSecHandler.setUserName(username);
        basicAuthSecHandler.setPassword(password);
        config.handlers(basicAuthSecHandler);
        return _httpGet(url, config);
    }

    private String _httpGet(String url, ClientConfig config) { 
        RestClient client = new RestClient();
        if (config != null) {
            client = new RestClient(config);
        }
        Resource resource = client.resource(url);
        return resource
            .header(&quot;Accept&quot;, &quot;application/json;q=1.0&quot;)
            .get()
            .getEntity(String.class);
    }
}"><i class="fa fa-files-o"></i></a>
        </div>
    
<pre class="cs-code"><code class="hljs"><span class="hljs-keyword">package</span> it.com.comsysto.kitchen.duty.rest;

<span class="hljs-keyword">import</span> org.apache.wink.client.ClientConfig;
<span class="hljs-keyword">import</span> org.apache.wink.client.Resource;
<span class="hljs-keyword">import</span> org.apache.wink.client.RestClient;
<span class="hljs-keyword">import</span> org.apache.wink.client.handlers.BasicAuthSecurityHandler;
<span class="hljs-keyword">import</span> org.junit.After;
<span class="hljs-keyword">import</span> org.junit.Before;
<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.assertEquals;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.assertNotNull;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserSearchResourceFuncTest</span> </span>{

    <span class="hljs-keyword">private</span> String baseUrl;

    <span class="hljs-annotation">@Before</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
        baseUrl = System.getProperty(<span class="hljs-string">"baseurl"</span>); <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="1"></span>
    }

    <span class="hljs-annotation">@After</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tearDown</span><span class="hljs-params">()</span> </span>{

    }

    <span class="hljs-annotation">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSearchUser__unAuthorized</span><span class="hljs-params">()</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="2"></span>
        String resourceUrl = baseUrl + <span class="hljs-string">"/rest/kitchenduty/1.0/user/search?query=adm"</span>;
        String response = httpGet(resourceUrl);
        assertNotNull(<span class="hljs-string">"should not be null"</span>, response);
        assertEquals(<span class="hljs-string">"should contain unauthorized message"</span>,
            toJSON(<span class="hljs-string">"{'message':'Client must be authenticated to access this resource.','status-code':401}"</span>),
            response);
    }
    <span class="hljs-annotation">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSearchUser__authorized</span><span class="hljs-params">()</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="3"></span>
        String resourceUrl = baseUrl + <span class="hljs-string">"/rest/kitchenduty/1.0/user/search?query=adm"</span>;
        String response = httpGet(resourceUrl, <span class="hljs-string">"admin"</span>, <span class="hljs-string">"admin"</span>);
        assertNotNull(<span class="hljs-string">"should not be null"</span>, response);
        assertEquals(<span class="hljs-string">"should contain admin"</span>,
            toJSON(<span class="hljs-string">"[{'text':'admin','id':'admin'}]"</span>),
            response);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">toJSON</span><span class="hljs-params">(String text)</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="4"></span>
        <span class="hljs-keyword">return</span> text.replaceAll(<span class="hljs-string">"'"</span>, <span class="hljs-string">"\""</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">httpGet</span><span class="hljs-params">(String url)</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="5"></span>
        <span class="hljs-keyword">return</span> _httpGet(url, <span class="hljs-keyword">null</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">httpGet</span><span class="hljs-params">(String url, String username, String password)</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="6"></span>
        ClientConfig config = <span class="hljs-keyword">new</span> ClientConfig();
        BasicAuthSecurityHandler basicAuthSecHandler = <span class="hljs-keyword">new</span> BasicAuthSecurityHandler();
        basicAuthSecHandler.setUserName(username);
        basicAuthSecHandler.setPassword(password);
        config.handlers(basicAuthSecHandler);
        <span class="hljs-keyword">return</span> _httpGet(url, config);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">_httpGet</span><span class="hljs-params">(String url, ClientConfig config)</span> </span>{ <span class="cs-source-point" data-cs-source-point-id="step2-usersearchresourcefunctest" data-cs-source-point-number="7"></span>
        RestClient client = <span class="hljs-keyword">new</span> RestClient();
        <span class="hljs-keyword">if</span> (config != <span class="hljs-keyword">null</span>) {
            client = <span class="hljs-keyword">new</span> RestClient(config);
        }
        Resource resource = client.resource(url);
        <span class="hljs-keyword">return</span> resource
            .header(<span class="hljs-string">"Accept"</span>, <span class="hljs-string">"application/json;q=1.0"</span>)
            .get()
            .getEntity(String.class);
    }
}</code></pre>

            </div>
            <div class="col-md-6">

                <div class="list-group cs-source-point-list" data-source-target="step2-usersearchresourcefunctest">
                    <div class="list-group-item cs-source-point-list__item">
                        Since we will be running a special SDK command to execute our Integrationtests the SDK will provide a system property
                        with the base URL to JIRA. We set that during <code>@Before</code> phase of our test.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        Our first test should test authentication, therefore we call our REST Resource without credentials and expect a <code>HTTP 401</code>.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        Our second test should test a valid response authenticated wit the user admin.
                        We search for <code>adm</code> and expect to get <code>admin</code> as result.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        This is just a little helper method to replace single quotes to double quotes,
                        so that we can easily write JSON with single quotes in our tests.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        A convenience Method to fire a HTTP GET request without authentication.
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        A convenience Method to fire a HTTP GET request with authentication (basic auth).
                    </div>
                    <div class="list-group-item cs-source-point-list__item">
                        The low-level HTTP GET method using the <code>wink</code> RestClient. You will need to write
                        more of it if your tests get more complex, but for us this is enough for now.
                    </div>
                </div>
            </div>

        </div>



        <p>
            Now we can run <code>atlas-integration-test</code> to run all our Integrationtests. You might want to get another coffee during that run, it takes some time.
        </p>


        
<div class="cs-shell">
    <div class="cs-shell__inner">
        <a class="cs-shell__copy-clipboard cs--trigger-copy-clipboard" data-clipboard-text="atlas-integration-test"
           data-toggle="tooltip" data-placement="left"
           data-title-orig="Copy file content to clipboard"
           title="Copy file content to clipboard"><i class="fa fa-files-o"></i></a>

        atlas-integration-test<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">[INFO] ------------------------------------------------------------------------
[INFO] Building kitchen-duty-plugin <span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-jira-plugin:<span class="hljs-number">6.1</span>.<span class="hljs-number">2</span>:compress-resources (default-compress-resources) @ kitchen-duty-plugin ---
[INFO] Compiling javascript using YUI
[INFO] <span class="hljs-number">0</span> Javascript file(s) were minified into target directory /Users/<span class="hljs-built_in">bg</span>/git-work/kitchen-duty-MASTER/step-<span class="hljs-number">02</span>-kitchen-duty-plugin/target/classes
[INFO] <span class="hljs-number">0</span> CSS file(s) were minified into target directory /Users/<span class="hljs-built_in">bg</span>/git-work/kitchen-duty-MASTER/step-<span class="hljs-number">02</span>-kitchen-duty-plugin/target/classes
[INFO] Compressing XML files
[INFO] <span class="hljs-number">0</span> XML file(s) were minified into target directory /Users/<span class="hljs-built_in">bg</span>/git-work/kitchen-duty-MASTER/step-<span class="hljs-number">02</span>-kitchen-duty-plugin/target/classes
[INFO]
....
[INFO] --- atlassian-spring-scanner-maven-plugin:<span class="hljs-number">1.2</span>.<span class="hljs-number">6</span>:atlassian-spring-scanner (default) @ kitchen-duty-plugin ---
[INFO] Starting Atlassian Spring Byte Code Scanner...
[INFO]

... <span class="hljs-number">4</span> million lines later ...

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.com.comsysto.kitchen.duty.MyComponentWiredTest
Tests run: <span class="hljs-number">1</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>, Time elapsed: <span class="hljs-number">1.248</span> sec
Running it.com.comsysto.kitchen.duty.rest.UserSearchResourceFuncTest
Tests run: <span class="hljs-number">2</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>, Time elapsed: <span class="hljs-number">1.018</span> sec

Results :

Tests run: <span class="hljs-number">3</span>, Failures: <span class="hljs-number">0</span>, Errors: <span class="hljs-number">0</span>, Skipped: <span class="hljs-number">0</span>

[INFO] jira: Shutting down
[INFO] using codehaus cargo v1.<span class="hljs-number">4.7</span>
...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: <span class="hljs-number">01</span>:<span class="hljs-number">10</span> min
[INFO] Finished at: <span class="hljs-number">2016</span>-<span class="hljs-number">03</span>-<span class="hljs-number">11</span>T19:<span class="hljs-number">38</span>:<span class="hljs-number">26</span>+<span class="hljs-number">01</span>:<span class="hljs-number">00</span>
[INFO] Final Memory: <span class="hljs-number">32</span>M/<span class="hljs-number">437</span>M
[INFO] ------------------------------------------------------------------------</code></pre>

    </div>
</div>



        <div class="cs-v-spacer"></div>


        <h3 class="cs-headline cs-headline--s">Finally let's do a manual test</h3>

        <p>
            Alright now it is time to startup and see what we get. Run the plugin with <code>atlas-run</code> and then we use Curl to search for users.
            Wait for atlas-run to startup JIRA and then fire a search request against our User Search REST Resource:
        </p>


        
<div class="cs-shell">
    <div class="cs-shell__inner">
        <a class="cs-shell__copy-clipboard cs--trigger-copy-clipboard" data-clipboard-text="curl --user admin:admin  http://localhost:2990/jira/rest/kitchenduty/1.0/user/search?query=adm"
           data-toggle="tooltip" data-placement="left"
           data-title-orig="Copy file content to clipboard"
           title="Copy file content to clipboard"><i class="fa fa-files-o"></i></a>

        curl --user admin:admin  http://localhost:2990/jira/rest/kitchenduty/1.0/user/search?query=adm<br>
        <pre class="cs-shell__output"><code class="hljs cs-shell__output-hljs">[{<span class="hljs-string">"text"</span>:<span class="hljs-string">"admin"</span>,<span class="hljs-string">"id"</span>:<span class="hljs-string">"admin"</span>}]</code></pre>

    </div>
</div>


        <p>
            Since we provided <code>?query=adm</code> we want a list of all user starting with <code>adm</code> which is currently only <code>admin</code>.
        </p>

        <div class="cs-v-spacer"></div>


        <div class="cs-tutorial-step-review">
            <div class="cs-tutorial-step-review__headline">
                <strong>You have completed Step 2.</strong> Good Job! You can check out this steps solution on GitHub
            </div>
            <div class="cs-tutorial-step-review__link">
                <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-02-kitchen-duty-plugin">
                    https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/tree/master/step-02-kitchen-duty-plugin
                </a>
                <br>
                Or view the diff from Step 1 to Step 2 here: <a href="https://github.com/comsysto/kitchen-duty-plugin-for-atlassian-jira/commit/32094a91a93b9e05c839975df3ce8aa104c94bb1">32094a9</a>
            </div>
        </div>

        <div class="cs-v-spacer"></div>
        <p>The graphic shows marked green <strong>which components we implemented in this section</strong>.</p>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-10 col-lg-offset-1 col-xl-8 col-xl-offset-2">
                
    <svg class="cs-interactive-graphic"
         id="p05-ig01"
         data-json-settings="{
                    &quot;markedAsDone&quot;: [ &quot;webwork-action&quot;, &quot;html-view&quot;, &quot;user-resource&quot;, &quot;user-search-resource-model&quot; ],
                    &quot;markedAsTodo&quot;: [ ],
                    &quot;markedAsGrayedOut&quot;: [ ],
                    &quot;onClick&quot;: [ ]
                }"
         data-svg-to-load="kitchen-duty-planning-page--component-overview"
         width="100%"
         viewBox="0 0 1043 654"
         preserveAspectRatio="xMaxYMax">
    </svg>

            </div>
        </div>
        <div class="cs-v-spacer cs-v-spacer--big"></div>
        <div class="cs-v-spacer cs-v-spacer--big"></div>





    </div>
</div>


</div>



<div class="cs-footer">
    <div class="cs-footer-left">
        <a class="cs-grey-footer-link" href="/kitchen-duty-plugin-for-atlassian-jira/author-and-license/">Author &amp; License</a> &middot;
        <a class="cs-grey-footer-link" href="/kitchen-duty-plugin-for-atlassian-jira/impressum-and-datenschutz/">Impressum &amp; Datenschutz</a>
        &middot;
        <a class="cs-grey-footer-link" href="/kitchen-duty-plugin-for-atlassian-jira/impressum-and-datenschutz/">Privacy</a>
    </div>
    <div class="cs-footer-right">
        <div class="container-fluid ">
            <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-6 cs-pager cs-page-header--left-fix">
                            <a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/04-step-01-planning-page--webwork-action-and-html-view/"><i class="fa fa-angle-left"></i> previous page</a>
                        </div>
                        <div class="col-md-6 text-xs-right cs-pager cs-page-header--right-fix">
                            
                                <a href="/kitchen-duty-plugin-for-atlassian-jira/tutorial/06-step-03-planning-page--user-search-js-controller/">next page <i class="fa fa-angle-right"></i></a>
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>







<script src="/kitchen-duty-plugin-for-atlassian-jira/generated/bundle.js" async></script>



</body>
</html>
